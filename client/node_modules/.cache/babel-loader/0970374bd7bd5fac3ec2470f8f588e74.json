{"ast":null,"code":"var _jsxFileName = \"/Users/krispol/Desktop/invoice/invoice-with-session/client/src/pages/company/companyInvoice/NewInvoice.js\";\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { setInvoiceInitState } from '../../../redux/actions/invoice';\nimport InvoiceDoc from './invoiceDoc/InvoiceDoc';\nimport NewInvoiceSubmit from './NewInvoiceSubmit';\nimport { alertUnsavedChanges } from '../../../components/form/utils/handleUnsavedChanges';\n\nclass NewInvoice extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      invoice: {}\n    };\n    this.handleChanges = this.handleChanges.bind(this);\n    this.clearInitState = this.clearInitState.bind(this);\n    this.updateInitStateToReduxStateOnSubmit = this.updateInitStateToReduxStateOnSubmit.bind(this);\n  }\n\n  handleChanges() {\n    alertUnsavedChanges(this.state.invoice, //initial state\n    this.props.invoice, //redux updated state\n    `/dashboard/companies/${this.props.company._id}?tab=invoices`, // this.props.setUpdates,\n    this.props.history);\n  }\n\n  updateInitStateToReduxStateOnSubmit() {// this.props.setUpdates(this.props.company.details);\n  }\n\n  clearInitState() {//on submit clear app updates\n    // this.props.setUpdates(null);\n  }\n\n  componentDidMount() {\n    const invoiceInitState = {\n      _id: null,\n      color: null,\n      notes: null,\n      savedAs: null,\n      createdAt: null,\n      profile: this.props.profile.details,\n      company: this.props.company.details,\n      tasks: this.props.company.tasks\n    };\n    this.setState({\n      invoice: JSON.parse(JSON.stringify(invoiceInitState))\n    });\n    console.log(this.state.invoice); // this.props.setUpdates(\n    //     JSON.parse(JSON.stringify(this.props.company.details))\n    // );\n    // window.addEventListener('beforeunload', this.props.clearInitState);\n  }\n\n  componentWillUnmount() {\n    //auth err and logout won't trigger fun\n    if (this.props.authenticated) this.handleChanges(); // window.removeEventListener('beforeunload', this.props.clearInitState);\n  }\n\n  render() {\n    console.log(this.state.invoice);\n    return /*#__PURE__*/React.createElement(\"section\", {\n      className: \"company-invoice\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"sr-only\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 17\n      }\n    }, \"Create a new invoice.\"), /*#__PURE__*/React.createElement(InvoiceDoc, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(NewInvoiceSubmit, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\n\nNewInvoice.propTypes = {\n  authenticated: PropTypes.bool,\n  profile: PropTypes.object,\n  company: PropTypes.object,\n  invoice: PropTypes.object\n};\n\nconst mapStateToProps = state => ({\n  authenticated: state.session.authenticated,\n  profile: state.profile,\n  company: state.companies.find(c => c._id === state.session.currentCompany),\n  invoice: state.invoice\n});\n\nconst mapDispatchToProps = {\n  setInvoiceInitState\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(NewInvoice));","map":{"version":3,"sources":["/Users/krispol/Desktop/invoice/invoice-with-session/client/src/pages/company/companyInvoice/NewInvoice.js"],"names":["React","Component","PropTypes","withRouter","connect","setInvoiceInitState","InvoiceDoc","NewInvoiceSubmit","alertUnsavedChanges","NewInvoice","constructor","props","state","invoice","handleChanges","bind","clearInitState","updateInitStateToReduxStateOnSubmit","company","_id","history","componentDidMount","invoiceInitState","color","notes","savedAs","createdAt","profile","details","tasks","setState","JSON","parse","stringify","console","log","componentWillUnmount","authenticated","render","propTypes","bool","object","mapStateToProps","session","companies","find","c","currentCompany","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { withRouter } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { setInvoiceInitState } from '../../../redux/actions/invoice';\nimport InvoiceDoc from './invoiceDoc/InvoiceDoc';\nimport NewInvoiceSubmit from './NewInvoiceSubmit';\nimport { alertUnsavedChanges } from '../../../components/form/utils/handleUnsavedChanges';\n\nclass NewInvoice extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            invoice: {},\n        };\n        this.handleChanges = this.handleChanges.bind(this);\n        this.clearInitState = this.clearInitState.bind(this);\n        this.updateInitStateToReduxStateOnSubmit = this.updateInitStateToReduxStateOnSubmit.bind(\n            this\n        );\n    }\n    handleChanges() {\n        alertUnsavedChanges(\n            this.state.invoice, //initial state\n            this.props.invoice, //redux updated state\n            `/dashboard/companies/${this.props.company._id}?tab=invoices`,\n            // this.props.setUpdates,\n            this.props.history\n        );\n    }\n    updateInitStateToReduxStateOnSubmit() {\n        // this.props.setUpdates(this.props.company.details);\n    }\n    clearInitState() {\n        //on submit clear app updates\n        // this.props.setUpdates(null);\n    }\n    componentDidMount() {\n        const invoiceInitState = {\n            _id: null,\n            color: null,\n            notes: null,\n            savedAs: null,\n            createdAt: null,\n            profile: this.props.profile.details,\n            company: this.props.company.details,\n            tasks: this.props.company.tasks,\n        };\n        this.setState({\n            invoice: JSON.parse(JSON.stringify(invoiceInitState)),\n        });\n        console.log(this.state.invoice);\n        // this.props.setUpdates(\n        //     JSON.parse(JSON.stringify(this.props.company.details))\n        // );\n        // window.addEventListener('beforeunload', this.props.clearInitState);\n    }\n    componentWillUnmount() {\n        //auth err and logout won't trigger fun\n        if (this.props.authenticated) this.handleChanges();\n        // window.removeEventListener('beforeunload', this.props.clearInitState);\n    }\n    render() {\n        console.log(this.state.invoice);\n        return (\n            <section className='company-invoice'>\n                <h2 className='sr-only'>Create a new invoice.</h2>\n                <InvoiceDoc />\n                <NewInvoiceSubmit />\n            </section>\n        );\n    }\n}\n\nNewInvoice.propTypes = {\n    authenticated: PropTypes.bool,\n    profile: PropTypes.object,\n    company: PropTypes.object,\n    invoice: PropTypes.object,\n};\n\nconst mapStateToProps = (state) => ({\n    authenticated: state.session.authenticated,\n    profile: state.profile,\n    company: state.companies.find(\n        (c) => c._id === state.session.currentCompany\n    ),\n    invoice: state.invoice,\n});\n\nconst mapDispatchToProps = {\n    setInvoiceInitState,\n};\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(withRouter(NewInvoice));\n"]},"metadata":{},"sourceType":"module"}