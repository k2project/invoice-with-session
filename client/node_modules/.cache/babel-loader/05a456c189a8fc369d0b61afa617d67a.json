{"ast":null,"code":"\"use strict\";\n\nconst webIDLConversions = require(\"webidl-conversions\");\n\nconst {\n  CSSStyleDeclaration\n} = require(\"cssstyle\");\n\nconst {\n  Performance: RawPerformance\n} = require(\"w3c-hr-time\");\n\nconst notImplemented = require(\"./not-implemented\");\n\nconst VirtualConsole = require(\"../virtual-console\");\n\nconst {\n  define,\n  mixin\n} = require(\"../utils\");\n\nconst EventTarget = require(\"../living/generated/EventTarget\");\n\nconst namedPropertiesWindow = require(\"../living/named-properties-window\");\n\nconst cssom = require(\"cssom\");\n\nconst postMessage = require(\"../living/post-message\");\n\nconst DOMException = require(\"domexception\");\n\nconst {\n  btoa,\n  atob\n} = require(\"abab\");\n\nconst idlUtils = require(\"../living/generated/utils\");\n\nconst createXMLHttpRequest = require(\"../living/xmlhttprequest\");\n\nconst createFileReader = require(\"../living/generated/FileReader\").createInterface;\n\nconst createWebSocket = require(\"../living/generated/WebSocket\").createInterface;\n\nconst WebSocketImpl = require(\"../living/websockets/WebSocket-impl\").implementation;\n\nconst BarProp = require(\"../living/generated/BarProp\");\n\nconst Document = require(\"../living/generated/Document\");\n\nconst External = require(\"../living/generated/External\");\n\nconst Navigator = require(\"../living/generated/Navigator\");\n\nconst Performance = require(\"../living/generated/Performance\");\n\nconst Screen = require(\"../living/generated/Screen\");\n\nconst Storage = require(\"../living/generated/Storage\");\n\nconst createAbortController = require(\"../living/generated/AbortController\").createInterface;\n\nconst createAbortSignal = require(\"../living/generated/AbortSignal\").createInterface;\n\nconst reportException = require(\"../living/helpers/runtime-script-errors\");\n\nconst {\n  matchesDontThrow\n} = require(\"../living/helpers/selectors\");\n\nconst SessionHistory = require(\"../living/window/SessionHistory\");\n\nconst {\n  contextifyWindow\n} = require(\"./documentfeatures.js\");\n\nconst GlobalEventHandlersImpl = require(\"../living/nodes/GlobalEventHandlers-impl\").implementation;\n\nconst WindowEventHandlersImpl = require(\"../living/nodes/WindowEventHandlers-impl\").implementation; // NB: the require() must be after assigning `module.exports` because this require() is circular\n// TODO: this above note might not even be true anymore... figure out the cycle and document it, or clean up.\n\n\nmodule.exports = Window;\n\nconst dom = require(\"../living\");\n\nconst cssSelectorSplitRE = /((?:[^,\"']|\"[^\"]*\"|'[^']*')+)/;\nconst defaultStyleSheet = cssom.parse(require(\"./default-stylesheet\"));\ndom.Window = Window; // NOTE: per https://heycam.github.io/webidl/#Global, all properties on the Window object must be own-properties.\n// That is why we assign everything inside of the constructor, instead of using a shared prototype.\n// You can verify this in e.g. Firefox or Internet Explorer, which do a good job with Web IDL compliance.\n\nfunction Window(options) {\n  EventTarget.setup(this);\n  const rawPerformance = new RawPerformance();\n  const windowInitialized = rawPerformance.now();\n  const window = this;\n  mixin(window, WindowEventHandlersImpl.prototype);\n  mixin(window, GlobalEventHandlersImpl.prototype);\n\n  this._initGlobalEvents(); ///// INTERFACES FROM THE DOM\n  // TODO: consider a mode of some sort where these are not shared between all DOM instances\n  // It'd be very memory-expensive in most cases, though.\n\n\n  for (const name in dom) {\n    Object.defineProperty(window, name, {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: dom[name]\n    });\n  } ///// PRIVATE DATA PROPERTIES\n  // vm initialization is deferred until script processing is activated\n\n\n  this._globalProxy = this;\n  Object.defineProperty(idlUtils.implForWrapper(this), idlUtils.wrapperSymbol, {\n    get: () => this._globalProxy\n  });\n  let timers = Object.create(null);\n  let animationFrameCallbacks = Object.create(null); // List options explicitly to be clear which are passed through\n\n  this._document = Document.create([], {\n    options: {\n      parsingMode: options.parsingMode,\n      contentType: options.contentType,\n      encoding: options.encoding,\n      cookieJar: options.cookieJar,\n      url: options.url,\n      lastModified: options.lastModified,\n      referrer: options.referrer,\n      cookie: options.cookie,\n      deferClose: options.deferClose,\n      resourceLoader: options.resourceLoader,\n      concurrentNodeIterators: options.concurrentNodeIterators,\n      pool: options.pool,\n      agent: options.agent,\n      agentClass: options.agentClass,\n      agentOptions: options.agentOptions,\n      strictSSL: options.strictSSL,\n      proxy: options.proxy,\n      parseOptions: options.parseOptions,\n      defaultView: this._globalProxy,\n      global: this\n    }\n  }); // https://html.spec.whatwg.org/#session-history\n\n  this._sessionHistory = new SessionHistory({\n    document: idlUtils.implForWrapper(this._document),\n    url: idlUtils.implForWrapper(this._document)._URL,\n    stateObject: null\n  }, this); // TODO NEWAPI can remove this\n\n  if (options.virtualConsole) {\n    if (options.virtualConsole instanceof VirtualConsole) {\n      this._virtualConsole = options.virtualConsole;\n    } else {\n      throw new TypeError(\"options.virtualConsole must be a VirtualConsole (from createVirtualConsole)\");\n    }\n  } else {\n    this._virtualConsole = new VirtualConsole();\n  }\n\n  this._runScripts = options.runScripts;\n\n  if (this._runScripts === \"outside-only\" || this._runScripts === \"dangerously\") {\n    contextifyWindow(this);\n  } // Set up the window as if it's a top level window.\n  // If it's not, then references will be corrected by frame/iframe code.\n\n\n  this._parent = this._top = this._globalProxy;\n  this._frameElement = null; // This implements window.frames.length, since window.frames returns a\n  // self reference to the window object.  This value is incremented in the\n  // HTMLFrameElement implementation.\n\n  this._length = 0;\n  this._pretendToBeVisual = options.pretendToBeVisual;\n  this._storageQuota = options.storageQuota; // Some properties (such as localStorage and sessionStorage) share data\n  // between windows in the same origin. This object is intended\n  // to contain such data.\n\n  if (options.commonForOrigin && options.commonForOrigin[this._document.origin]) {\n    this._commonForOrigin = options.commonForOrigin;\n  } else {\n    this._commonForOrigin = {\n      [this._document.origin]: {\n        localStorageArea: new Map(),\n        sessionStorageArea: new Map(),\n        windowsInSameOrigin: [this]\n      }\n    };\n  }\n\n  this._currentOriginData = this._commonForOrigin[this._document.origin]; ///// WEB STORAGE\n\n  this._localStorage = Storage.create([], {\n    associatedWindow: this,\n    storageArea: this._currentOriginData.localStorageArea,\n    type: \"localStorage\",\n    url: this._document.documentURI,\n    storageQuota: this._storageQuota\n  });\n  this._sessionStorage = Storage.create([], {\n    associatedWindow: this,\n    storageArea: this._currentOriginData.sessionStorageArea,\n    type: \"sessionStorage\",\n    url: this._document.documentURI,\n    storageQuota: this._storageQuota\n  }); ///// GETTERS\n\n  const locationbar = BarProp.create();\n  const menubar = BarProp.create();\n  const personalbar = BarProp.create();\n  const scrollbars = BarProp.create();\n  const statusbar = BarProp.create();\n  const toolbar = BarProp.create();\n  const external = External.create();\n  const navigator = Navigator.create([], {\n    userAgent: options.userAgent\n  });\n  const performance = Performance.create([], {\n    rawPerformance\n  });\n  const screen = Screen.create();\n  define(this, {\n    get length() {\n      return window._length;\n    },\n\n    get window() {\n      return window._globalProxy;\n    },\n\n    get frameElement() {\n      return window._frameElement;\n    },\n\n    get frames() {\n      return window._globalProxy;\n    },\n\n    get self() {\n      return window._globalProxy;\n    },\n\n    get parent() {\n      return window._parent;\n    },\n\n    get top() {\n      return window._top;\n    },\n\n    get document() {\n      return window._document;\n    },\n\n    get external() {\n      return external;\n    },\n\n    get location() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._location);\n    },\n\n    get history() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._history);\n    },\n\n    get navigator() {\n      return navigator;\n    },\n\n    get locationbar() {\n      return locationbar;\n    },\n\n    get menubar() {\n      return menubar;\n    },\n\n    get personalbar() {\n      return personalbar;\n    },\n\n    get scrollbars() {\n      return scrollbars;\n    },\n\n    get statusbar() {\n      return statusbar;\n    },\n\n    get toolbar() {\n      return toolbar;\n    },\n\n    get performance() {\n      return performance;\n    },\n\n    get screen() {\n      return screen;\n    },\n\n    get localStorage() {\n      if (this._document.origin === \"null\") {\n        throw new DOMException(\"localStorage is not available for opaque origins\", \"SecurityError\");\n      }\n\n      return this._localStorage;\n    },\n\n    get sessionStorage() {\n      if (this._document.origin === \"null\") {\n        throw new DOMException(\"sessionStorage is not available for opaque origins\", \"SecurityError\");\n      }\n\n      return this._sessionStorage;\n    }\n\n  });\n  namedPropertiesWindow.initializeWindow(this, this._globalProxy); ///// METHODS for [ImplicitThis] hack\n  // See https://lists.w3.org/Archives/Public/public-script-coord/2015JanMar/0109.html\n\n  this.addEventListener = this.addEventListener.bind(this);\n  this.removeEventListener = this.removeEventListener.bind(this);\n  this.dispatchEvent = this.dispatchEvent.bind(this); ///// METHODS\n\n  let latestTimerId = 0;\n  let latestAnimationFrameCallbackId = 0;\n\n  this.setTimeout = function (fn, ms) {\n    const args = [];\n\n    for (let i = 2; i < arguments.length; ++i) {\n      args[i - 2] = arguments[i];\n    }\n\n    return startTimer(window, setTimeout, clearTimeout, ++latestTimerId, fn, ms, timers, args);\n  };\n\n  this.setInterval = function (fn, ms) {\n    const args = [];\n\n    for (let i = 2; i < arguments.length; ++i) {\n      args[i - 2] = arguments[i];\n    }\n\n    return startTimer(window, setInterval, clearInterval, ++latestTimerId, fn, ms, timers, args);\n  };\n\n  this.clearInterval = stopTimer.bind(this, timers);\n  this.clearTimeout = stopTimer.bind(this, timers);\n\n  if (this._pretendToBeVisual) {\n    this.requestAnimationFrame = fn => {\n      const timestamp = rawPerformance.now() - windowInitialized;\n      const fps = 1000 / 60;\n      return startTimer(window, setTimeout, clearTimeout, ++latestAnimationFrameCallbackId, fn, fps, animationFrameCallbacks, [timestamp]);\n    };\n\n    this.cancelAnimationFrame = stopTimer.bind(this, animationFrameCallbacks);\n  }\n\n  this.__stopAllTimers = function () {\n    stopAllTimers(timers);\n    stopAllTimers(animationFrameCallbacks);\n    latestTimerId = 0;\n    latestAnimationFrameCallbackId = 0;\n    timers = Object.create(null);\n    animationFrameCallbacks = Object.create(null);\n  };\n\n  function Option(text, value, defaultSelected, selected) {\n    if (text === undefined) {\n      text = \"\";\n    }\n\n    text = webIDLConversions.DOMString(text);\n\n    if (value !== undefined) {\n      value = webIDLConversions.DOMString(value);\n    }\n\n    defaultSelected = webIDLConversions.boolean(defaultSelected);\n    selected = webIDLConversions.boolean(selected);\n\n    const option = window._document.createElement(\"option\");\n\n    const impl = idlUtils.implForWrapper(option);\n\n    if (text !== \"\") {\n      impl.text = text;\n    }\n\n    if (value !== undefined) {\n      impl.setAttribute(\"value\", value);\n    }\n\n    if (defaultSelected) {\n      impl.setAttribute(\"selected\", \"\");\n    }\n\n    impl._selectedness = selected;\n    return option;\n  }\n\n  Object.defineProperty(Option, \"prototype\", {\n    value: this.HTMLOptionElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Option\", {\n    value: Option,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n\n  function Image() {\n    const img = window._document.createElement(\"img\");\n\n    const impl = idlUtils.implForWrapper(img);\n\n    if (arguments.length > 0) {\n      impl.setAttribute(\"width\", String(arguments[0]));\n    }\n\n    if (arguments.length > 1) {\n      impl.setAttribute(\"height\", String(arguments[1]));\n    }\n\n    return img;\n  }\n\n  Object.defineProperty(Image, \"prototype\", {\n    value: this.HTMLImageElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Image\", {\n    value: Image,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n\n  function Audio(src) {\n    const audio = window._document.createElement(\"audio\");\n\n    const impl = idlUtils.implForWrapper(audio);\n    impl.setAttribute(\"preload\", \"auto\");\n\n    if (src !== undefined) {\n      impl.setAttribute(\"src\", String(src));\n    }\n\n    return audio;\n  }\n\n  Object.defineProperty(Audio, \"prototype\", {\n    value: this.HTMLAudioElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Audio\", {\n    value: Audio,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n\n  function wrapConsoleMethod(method) {\n    return (...args) => {\n      window._virtualConsole.emit(method, ...args);\n    };\n  }\n\n  this.postMessage = postMessage;\n\n  this.atob = function (str) {\n    const result = atob(str);\n\n    if (result === null) {\n      throw new DOMException(\"The string to be decoded contains invalid characters.\", \"InvalidCharacterError\");\n    }\n\n    return result;\n  };\n\n  this.btoa = function (str) {\n    const result = btoa(str);\n\n    if (result === null) {\n      throw new DOMException(\"The string to be encoded contains invalid characters.\", \"InvalidCharacterError\");\n    }\n\n    return result;\n  };\n\n  this.FileReader = createFileReader({\n    window: this\n  }).interface;\n  this.WebSocket = createWebSocket({\n    window: this\n  }).interface;\n  const AbortSignalWrapper = createAbortSignal({\n    window: this\n  });\n  this.AbortSignal = AbortSignalWrapper.interface;\n  this.AbortController = createAbortController({\n    AbortSignal: AbortSignalWrapper\n  }).interface;\n  this.XMLHttpRequest = createXMLHttpRequest(this); // TODO: necessary for Blob and FileReader due to different-globals weirdness; investigate how to avoid this.\n\n  this.ArrayBuffer = ArrayBuffer;\n  this.Int8Array = Int8Array;\n  this.Uint8Array = Uint8Array;\n  this.Uint8ClampedArray = Uint8ClampedArray;\n  this.Int16Array = Int16Array;\n  this.Uint16Array = Uint16Array;\n  this.Int32Array = Int32Array;\n  this.Uint32Array = Uint32Array;\n  this.Float32Array = Float32Array;\n  this.Float64Array = Float64Array;\n\n  this.stop = function () {\n    const manager = idlUtils.implForWrapper(this._document)._requestManager;\n\n    if (manager) {\n      manager.close();\n    }\n  };\n\n  this.close = function () {\n    // Recursively close child frame windows, then ourselves.\n    const currentWindow = this;\n\n    (function windowCleaner(windowToClean) {\n      for (let i = 0; i < windowToClean.length; i++) {\n        windowCleaner(windowToClean[i]);\n      } // We\"re already in our own window.close().\n\n\n      if (windowToClean !== currentWindow) {\n        windowToClean.close();\n      }\n    })(this); // Clear out all listeners. Any in-flight or upcoming events should not get delivered.\n\n\n    idlUtils.implForWrapper(this)._eventListeners = Object.create(null);\n\n    if (this._document) {\n      if (this._document.body) {\n        this._document.body.innerHTML = \"\";\n      }\n\n      if (this._document.close) {\n        // It's especially important to clear out the listeners here because document.close() causes a \"load\" event to\n        // fire.\n        idlUtils.implForWrapper(this._document)._eventListeners = Object.create(null);\n\n        this._document.close();\n      }\n\n      const doc = idlUtils.implForWrapper(this._document);\n\n      if (doc._requestManager) {\n        doc._requestManager.close();\n      }\n\n      delete this._document;\n    }\n\n    this.__stopAllTimers();\n\n    WebSocketImpl.cleanUpWindow(this);\n  };\n\n  this.getComputedStyle = function (node) {\n    const nodeImpl = idlUtils.implForWrapper(node);\n    const s = node.style;\n    const cs = new CSSStyleDeclaration();\n    const {\n      forEach\n    } = Array.prototype;\n\n    function setPropertiesFromRule(rule) {\n      if (!rule.selectorText) {\n        return;\n      }\n\n      const selectors = rule.selectorText.split(cssSelectorSplitRE);\n      let matched = false;\n\n      for (const selectorText of selectors) {\n        if (selectorText !== \"\" && selectorText !== \",\" && !matched && matchesDontThrow(nodeImpl, selectorText)) {\n          matched = true;\n          forEach.call(rule.style, property => {\n            cs.setProperty(property, rule.style.getPropertyValue(property), rule.style.getPropertyPriority(property));\n          });\n        }\n      }\n    }\n\n    function readStylesFromStyleSheet(sheet) {\n      forEach.call(sheet.cssRules, rule => {\n        if (rule.media) {\n          if (Array.prototype.indexOf.call(rule.media, \"screen\") !== -1) {\n            forEach.call(rule.cssRules, setPropertiesFromRule);\n          }\n        } else {\n          setPropertiesFromRule(rule);\n        }\n      });\n    }\n\n    readStylesFromStyleSheet(defaultStyleSheet);\n    forEach.call(node.ownerDocument.styleSheets, readStylesFromStyleSheet);\n    forEach.call(s, property => {\n      cs.setProperty(property, s.getPropertyValue(property), s.getPropertyPriority(property));\n    });\n    return cs;\n  }; // The captureEvents() and releaseEvents() methods must do nothing\n\n\n  this.captureEvents = function () {};\n\n  this.releaseEvents = function () {}; ///// PUBLIC DATA PROPERTIES (TODO: should be getters)\n\n\n  this.console = {\n    assert: wrapConsoleMethod(\"assert\"),\n    clear: wrapConsoleMethod(\"clear\"),\n    count: wrapConsoleMethod(\"count\"),\n    debug: wrapConsoleMethod(\"debug\"),\n    error: wrapConsoleMethod(\"error\"),\n    group: wrapConsoleMethod(\"group\"),\n    groupCollapsed: wrapConsoleMethod(\"groupCollapsed\"),\n    groupEnd: wrapConsoleMethod(\"groupEnd\"),\n    info: wrapConsoleMethod(\"info\"),\n    log: wrapConsoleMethod(\"log\"),\n    table: wrapConsoleMethod(\"table\"),\n    time: wrapConsoleMethod(\"time\"),\n    timeEnd: wrapConsoleMethod(\"timeEnd\"),\n    trace: wrapConsoleMethod(\"trace\"),\n    warn: wrapConsoleMethod(\"warn\")\n  };\n\n  function notImplementedMethod(name) {\n    return function () {\n      notImplemented(name, window);\n    };\n  }\n\n  define(this, {\n    name: \"nodejs\",\n    // Node v6 has issues (presumably in the vm module)\n    // which this property exposes through an XHR test\n    // status: \"\",\n    devicePixelRatio: 1,\n    innerWidth: 1024,\n    innerHeight: 768,\n    outerWidth: 1024,\n    outerHeight: 768,\n    pageXOffset: 0,\n    pageYOffset: 0,\n    screenX: 0,\n    screenY: 0,\n    scrollX: 0,\n    scrollY: 0,\n    // Not in spec, but likely to be added eventually:\n    // https://github.com/w3c/csswg-drafts/issues/1091\n    screenLeft: 0,\n    screenTop: 0,\n    alert: notImplementedMethod(\"window.alert\"),\n    blur: notImplementedMethod(\"window.blur\"),\n    confirm: notImplementedMethod(\"window.confirm\"),\n    focus: notImplementedMethod(\"window.focus\"),\n    moveBy: notImplementedMethod(\"window.moveBy\"),\n    moveTo: notImplementedMethod(\"window.moveTo\"),\n    open: notImplementedMethod(\"window.open\"),\n    print: notImplementedMethod(\"window.print\"),\n    prompt: notImplementedMethod(\"window.prompt\"),\n    resizeBy: notImplementedMethod(\"window.resizeBy\"),\n    resizeTo: notImplementedMethod(\"window.resizeTo\"),\n    scroll: notImplementedMethod(\"window.scroll\"),\n    scrollBy: notImplementedMethod(\"window.scrollBy\"),\n    scrollTo: notImplementedMethod(\"window.scrollTo\")\n  }); ///// INITIALIZATION\n\n  process.nextTick(() => {\n    if (!window.document) {\n      return; // window might've been closed already\n    }\n\n    if (window.document.readyState === \"complete\") {\n      const ev = window.document.createEvent(\"HTMLEvents\");\n      ev.initEvent(\"load\", false, false);\n      window.dispatchEvent(ev);\n    } else {\n      window.document.addEventListener(\"load\", () => {\n        const ev = window.document.createEvent(\"HTMLEvents\");\n        ev.initEvent(\"load\", false, false);\n        window.dispatchEvent(ev);\n      });\n    }\n  });\n}\n\nObject.setPrototypeOf(Window, EventTarget.interface);\nObject.setPrototypeOf(Window.prototype, EventTarget.interface.prototype);\nObject.defineProperty(Window.prototype, Symbol.toStringTag, {\n  value: \"Window\",\n  writable: false,\n  enumerable: false,\n  configurable: true\n});\n\nfunction startTimer(window, startFn, stopFn, timerId, callback, ms, timerStorage, args) {\n  if (!window || !window._document) {\n    return undefined;\n  }\n\n  if (typeof callback !== \"function\") {\n    const code = String(callback);\n    callback = window._globalProxy.eval.bind(window, code + `\\n//# sourceURL=${window.location.href}`);\n  }\n\n  const oldCallback = callback;\n\n  callback = () => {\n    try {\n      oldCallback.apply(window._globalProxy, args);\n    } catch (e) {\n      reportException(window, e, window.location.href);\n    }\n  };\n\n  const res = startFn(callback, ms);\n  timerStorage[timerId] = [res, stopFn];\n  return timerId;\n}\n\nfunction stopTimer(timerStorage, id) {\n  const timer = timerStorage[id];\n\n  if (timer) {\n    // Need to .call() with undefined to ensure the thisArg is not timer itself\n    timer[1].call(undefined, timer[0]);\n    delete timerStorage[id];\n  }\n}\n\nfunction stopAllTimers(timers) {\n  Object.keys(timers).forEach(key => {\n    const timer = timers[key]; // Need to .call() with undefined to ensure the thisArg is not timer itself\n\n    timer[1].call(undefined, timer[0]);\n  });\n}","map":{"version":3,"sources":["/Users/krispol/Desktop/invoice/invoice-with-session/client/node_modules/jsdom/lib/jsdom/browser/Window.js"],"names":["webIDLConversions","require","CSSStyleDeclaration","Performance","RawPerformance","notImplemented","VirtualConsole","define","mixin","EventTarget","namedPropertiesWindow","cssom","postMessage","DOMException","btoa","atob","idlUtils","createXMLHttpRequest","createFileReader","createInterface","createWebSocket","WebSocketImpl","implementation","BarProp","Document","External","Navigator","Screen","Storage","createAbortController","createAbortSignal","reportException","matchesDontThrow","SessionHistory","contextifyWindow","GlobalEventHandlersImpl","WindowEventHandlersImpl","module","exports","Window","dom","cssSelectorSplitRE","defaultStyleSheet","parse","options","setup","rawPerformance","windowInitialized","now","window","prototype","_initGlobalEvents","name","Object","defineProperty","enumerable","configurable","writable","value","_globalProxy","implForWrapper","wrapperSymbol","get","timers","create","animationFrameCallbacks","_document","parsingMode","contentType","encoding","cookieJar","url","lastModified","referrer","cookie","deferClose","resourceLoader","concurrentNodeIterators","pool","agent","agentClass","agentOptions","strictSSL","proxy","parseOptions","defaultView","global","_sessionHistory","document","_URL","stateObject","virtualConsole","_virtualConsole","TypeError","_runScripts","runScripts","_parent","_top","_frameElement","_length","_pretendToBeVisual","pretendToBeVisual","_storageQuota","storageQuota","commonForOrigin","origin","_commonForOrigin","localStorageArea","Map","sessionStorageArea","windowsInSameOrigin","_currentOriginData","_localStorage","associatedWindow","storageArea","type","documentURI","_sessionStorage","locationbar","menubar","personalbar","scrollbars","statusbar","toolbar","external","navigator","userAgent","performance","screen","length","frameElement","frames","self","parent","top","location","wrapperForImpl","_location","history","_history","localStorage","sessionStorage","initializeWindow","addEventListener","bind","removeEventListener","dispatchEvent","latestTimerId","latestAnimationFrameCallbackId","setTimeout","fn","ms","args","i","arguments","startTimer","clearTimeout","setInterval","clearInterval","stopTimer","requestAnimationFrame","timestamp","fps","cancelAnimationFrame","__stopAllTimers","stopAllTimers","Option","text","defaultSelected","selected","undefined","DOMString","boolean","option","createElement","impl","setAttribute","_selectedness","HTMLOptionElement","Image","img","String","HTMLImageElement","Audio","src","audio","HTMLAudioElement","wrapConsoleMethod","method","emit","str","result","FileReader","interface","WebSocket","AbortSignalWrapper","AbortSignal","AbortController","XMLHttpRequest","ArrayBuffer","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","stop","manager","_requestManager","close","currentWindow","windowCleaner","windowToClean","_eventListeners","body","innerHTML","doc","cleanUpWindow","getComputedStyle","node","nodeImpl","s","style","cs","forEach","Array","setPropertiesFromRule","rule","selectorText","selectors","split","matched","call","property","setProperty","getPropertyValue","getPropertyPriority","readStylesFromStyleSheet","sheet","cssRules","media","indexOf","ownerDocument","styleSheets","captureEvents","releaseEvents","console","assert","clear","count","debug","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","trace","warn","notImplementedMethod","devicePixelRatio","innerWidth","innerHeight","outerWidth","outerHeight","pageXOffset","pageYOffset","screenX","screenY","scrollX","scrollY","screenLeft","screenTop","alert","blur","confirm","focus","moveBy","moveTo","open","print","prompt","resizeBy","resizeTo","scroll","scrollBy","scrollTo","process","nextTick","readyState","ev","createEvent","initEvent","setPrototypeOf","Symbol","toStringTag","startFn","stopFn","timerId","callback","timerStorage","code","eval","href","oldCallback","apply","e","res","id","timer","keys","key"],"mappings":"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","sourcesContent":["\"use strict\";\n\nconst webIDLConversions = require(\"webidl-conversions\");\nconst { CSSStyleDeclaration } = require(\"cssstyle\");\nconst { Performance: RawPerformance } = require(\"w3c-hr-time\");\nconst notImplemented = require(\"./not-implemented\");\nconst VirtualConsole = require(\"../virtual-console\");\nconst { define, mixin } = require(\"../utils\");\nconst EventTarget = require(\"../living/generated/EventTarget\");\nconst namedPropertiesWindow = require(\"../living/named-properties-window\");\nconst cssom = require(\"cssom\");\nconst postMessage = require(\"../living/post-message\");\nconst DOMException = require(\"domexception\");\nconst { btoa, atob } = require(\"abab\");\nconst idlUtils = require(\"../living/generated/utils\");\nconst createXMLHttpRequest = require(\"../living/xmlhttprequest\");\nconst createFileReader = require(\"../living/generated/FileReader\").createInterface;\nconst createWebSocket = require(\"../living/generated/WebSocket\").createInterface;\nconst WebSocketImpl = require(\"../living/websockets/WebSocket-impl\").implementation;\nconst BarProp = require(\"../living/generated/BarProp\");\nconst Document = require(\"../living/generated/Document\");\nconst External = require(\"../living/generated/External\");\nconst Navigator = require(\"../living/generated/Navigator\");\nconst Performance = require(\"../living/generated/Performance\");\nconst Screen = require(\"../living/generated/Screen\");\nconst Storage = require(\"../living/generated/Storage\");\nconst createAbortController = require(\"../living/generated/AbortController\").createInterface;\nconst createAbortSignal = require(\"../living/generated/AbortSignal\").createInterface;\nconst reportException = require(\"../living/helpers/runtime-script-errors\");\nconst { matchesDontThrow } = require(\"../living/helpers/selectors\");\nconst SessionHistory = require(\"../living/window/SessionHistory\");\nconst { contextifyWindow } = require(\"./documentfeatures.js\");\n\nconst GlobalEventHandlersImpl = require(\"../living/nodes/GlobalEventHandlers-impl\").implementation;\nconst WindowEventHandlersImpl = require(\"../living/nodes/WindowEventHandlers-impl\").implementation;\n\n// NB: the require() must be after assigning `module.exports` because this require() is circular\n// TODO: this above note might not even be true anymore... figure out the cycle and document it, or clean up.\nmodule.exports = Window;\nconst dom = require(\"../living\");\n\nconst cssSelectorSplitRE = /((?:[^,\"']|\"[^\"]*\"|'[^']*')+)/;\n\nconst defaultStyleSheet = cssom.parse(require(\"./default-stylesheet\"));\n\ndom.Window = Window;\n\n// NOTE: per https://heycam.github.io/webidl/#Global, all properties on the Window object must be own-properties.\n// That is why we assign everything inside of the constructor, instead of using a shared prototype.\n// You can verify this in e.g. Firefox or Internet Explorer, which do a good job with Web IDL compliance.\n\nfunction Window(options) {\n  EventTarget.setup(this);\n\n  const rawPerformance = new RawPerformance();\n  const windowInitialized = rawPerformance.now();\n\n  const window = this;\n\n  mixin(window, WindowEventHandlersImpl.prototype);\n  mixin(window, GlobalEventHandlersImpl.prototype);\n\n  this._initGlobalEvents();\n\n  ///// INTERFACES FROM THE DOM\n  // TODO: consider a mode of some sort where these are not shared between all DOM instances\n  // It'd be very memory-expensive in most cases, though.\n  for (const name in dom) {\n    Object.defineProperty(window, name, {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: dom[name]\n    });\n  }\n\n  ///// PRIVATE DATA PROPERTIES\n\n  // vm initialization is deferred until script processing is activated\n  this._globalProxy = this;\n  Object.defineProperty(idlUtils.implForWrapper(this), idlUtils.wrapperSymbol, { get: () => this._globalProxy });\n\n  let timers = Object.create(null);\n  let animationFrameCallbacks = Object.create(null);\n\n  // List options explicitly to be clear which are passed through\n  this._document = Document.create([], {\n    options: {\n      parsingMode: options.parsingMode,\n      contentType: options.contentType,\n      encoding: options.encoding,\n      cookieJar: options.cookieJar,\n      url: options.url,\n      lastModified: options.lastModified,\n      referrer: options.referrer,\n      cookie: options.cookie,\n      deferClose: options.deferClose,\n      resourceLoader: options.resourceLoader,\n      concurrentNodeIterators: options.concurrentNodeIterators,\n      pool: options.pool,\n      agent: options.agent,\n      agentClass: options.agentClass,\n      agentOptions: options.agentOptions,\n      strictSSL: options.strictSSL,\n      proxy: options.proxy,\n      parseOptions: options.parseOptions,\n      defaultView: this._globalProxy,\n      global: this\n    }\n  });\n  // https://html.spec.whatwg.org/#session-history\n  this._sessionHistory = new SessionHistory({\n    document: idlUtils.implForWrapper(this._document),\n    url: idlUtils.implForWrapper(this._document)._URL,\n    stateObject: null\n  }, this);\n\n  // TODO NEWAPI can remove this\n  if (options.virtualConsole) {\n    if (options.virtualConsole instanceof VirtualConsole) {\n      this._virtualConsole = options.virtualConsole;\n    } else {\n      throw new TypeError(\"options.virtualConsole must be a VirtualConsole (from createVirtualConsole)\");\n    }\n  } else {\n    this._virtualConsole = new VirtualConsole();\n  }\n\n  this._runScripts = options.runScripts;\n  if (this._runScripts === \"outside-only\" || this._runScripts === \"dangerously\") {\n    contextifyWindow(this);\n  }\n\n  // Set up the window as if it's a top level window.\n  // If it's not, then references will be corrected by frame/iframe code.\n  this._parent = this._top = this._globalProxy;\n  this._frameElement = null;\n\n  // This implements window.frames.length, since window.frames returns a\n  // self reference to the window object.  This value is incremented in the\n  // HTMLFrameElement implementation.\n  this._length = 0;\n\n  this._pretendToBeVisual = options.pretendToBeVisual;\n  this._storageQuota = options.storageQuota;\n\n  // Some properties (such as localStorage and sessionStorage) share data\n  // between windows in the same origin. This object is intended\n  // to contain such data.\n  if (options.commonForOrigin && options.commonForOrigin[this._document.origin]) {\n    this._commonForOrigin = options.commonForOrigin;\n  } else {\n    this._commonForOrigin = {\n      [this._document.origin]: {\n        localStorageArea: new Map(),\n        sessionStorageArea: new Map(),\n        windowsInSameOrigin: [this]\n      }\n    };\n  }\n\n  this._currentOriginData = this._commonForOrigin[this._document.origin];\n\n  ///// WEB STORAGE\n\n  this._localStorage = Storage.create([], {\n    associatedWindow: this,\n    storageArea: this._currentOriginData.localStorageArea,\n    type: \"localStorage\",\n    url: this._document.documentURI,\n    storageQuota: this._storageQuota\n  });\n  this._sessionStorage = Storage.create([], {\n    associatedWindow: this,\n    storageArea: this._currentOriginData.sessionStorageArea,\n    type: \"sessionStorage\",\n    url: this._document.documentURI,\n    storageQuota: this._storageQuota\n  });\n\n  ///// GETTERS\n\n  const locationbar = BarProp.create();\n  const menubar = BarProp.create();\n  const personalbar = BarProp.create();\n  const scrollbars = BarProp.create();\n  const statusbar = BarProp.create();\n  const toolbar = BarProp.create();\n  const external = External.create();\n  const navigator = Navigator.create([], { userAgent: options.userAgent });\n  const performance = Performance.create([], { rawPerformance });\n  const screen = Screen.create();\n\n  define(this, {\n    get length() {\n      return window._length;\n    },\n    get window() {\n      return window._globalProxy;\n    },\n    get frameElement() {\n      return window._frameElement;\n    },\n    get frames() {\n      return window._globalProxy;\n    },\n    get self() {\n      return window._globalProxy;\n    },\n    get parent() {\n      return window._parent;\n    },\n    get top() {\n      return window._top;\n    },\n    get document() {\n      return window._document;\n    },\n    get external() {\n      return external;\n    },\n    get location() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._location);\n    },\n    get history() {\n      return idlUtils.wrapperForImpl(idlUtils.implForWrapper(window._document)._history);\n    },\n    get navigator() {\n      return navigator;\n    },\n    get locationbar() {\n      return locationbar;\n    },\n    get menubar() {\n      return menubar;\n    },\n    get personalbar() {\n      return personalbar;\n    },\n    get scrollbars() {\n      return scrollbars;\n    },\n    get statusbar() {\n      return statusbar;\n    },\n    get toolbar() {\n      return toolbar;\n    },\n    get performance() {\n      return performance;\n    },\n    get screen() {\n      return screen;\n    },\n    get localStorage() {\n      if (this._document.origin === \"null\") {\n        throw new DOMException(\"localStorage is not available for opaque origins\", \"SecurityError\");\n      }\n\n      return this._localStorage;\n    },\n    get sessionStorage() {\n      if (this._document.origin === \"null\") {\n        throw new DOMException(\"sessionStorage is not available for opaque origins\", \"SecurityError\");\n      }\n\n      return this._sessionStorage;\n    }\n  });\n\n  namedPropertiesWindow.initializeWindow(this, this._globalProxy);\n\n  ///// METHODS for [ImplicitThis] hack\n  // See https://lists.w3.org/Archives/Public/public-script-coord/2015JanMar/0109.html\n  this.addEventListener = this.addEventListener.bind(this);\n  this.removeEventListener = this.removeEventListener.bind(this);\n  this.dispatchEvent = this.dispatchEvent.bind(this);\n\n  ///// METHODS\n\n  let latestTimerId = 0;\n  let latestAnimationFrameCallbackId = 0;\n\n  this.setTimeout = function (fn, ms) {\n    const args = [];\n    for (let i = 2; i < arguments.length; ++i) {\n      args[i - 2] = arguments[i];\n    }\n    return startTimer(window, setTimeout, clearTimeout, ++latestTimerId, fn, ms, timers, args);\n  };\n  this.setInterval = function (fn, ms) {\n    const args = [];\n    for (let i = 2; i < arguments.length; ++i) {\n      args[i - 2] = arguments[i];\n    }\n    return startTimer(window, setInterval, clearInterval, ++latestTimerId, fn, ms, timers, args);\n  };\n  this.clearInterval = stopTimer.bind(this, timers);\n  this.clearTimeout = stopTimer.bind(this, timers);\n\n  if (this._pretendToBeVisual) {\n    this.requestAnimationFrame = fn => {\n      const timestamp = rawPerformance.now() - windowInitialized;\n      const fps = 1000 / 60;\n\n      return startTimer(\n        window,\n        setTimeout,\n        clearTimeout,\n        ++latestAnimationFrameCallbackId,\n        fn,\n        fps,\n        animationFrameCallbacks,\n        [timestamp]\n      );\n    };\n    this.cancelAnimationFrame = stopTimer.bind(this, animationFrameCallbacks);\n  }\n\n  this.__stopAllTimers = function () {\n    stopAllTimers(timers);\n    stopAllTimers(animationFrameCallbacks);\n\n    latestTimerId = 0;\n    latestAnimationFrameCallbackId = 0;\n\n    timers = Object.create(null);\n    animationFrameCallbacks = Object.create(null);\n  };\n\n  function Option(text, value, defaultSelected, selected) {\n    if (text === undefined) {\n      text = \"\";\n    }\n    text = webIDLConversions.DOMString(text);\n\n    if (value !== undefined) {\n      value = webIDLConversions.DOMString(value);\n    }\n\n    defaultSelected = webIDLConversions.boolean(defaultSelected);\n    selected = webIDLConversions.boolean(selected);\n\n    const option = window._document.createElement(\"option\");\n    const impl = idlUtils.implForWrapper(option);\n\n    if (text !== \"\") {\n      impl.text = text;\n    }\n    if (value !== undefined) {\n      impl.setAttribute(\"value\", value);\n    }\n    if (defaultSelected) {\n      impl.setAttribute(\"selected\", \"\");\n    }\n    impl._selectedness = selected;\n\n    return option;\n  }\n  Object.defineProperty(Option, \"prototype\", {\n    value: this.HTMLOptionElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Option\", {\n    value: Option,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n\n  function Image() {\n    const img = window._document.createElement(\"img\");\n    const impl = idlUtils.implForWrapper(img);\n\n    if (arguments.length > 0) {\n      impl.setAttribute(\"width\", String(arguments[0]));\n    }\n    if (arguments.length > 1) {\n      impl.setAttribute(\"height\", String(arguments[1]));\n    }\n\n    return img;\n  }\n  Object.defineProperty(Image, \"prototype\", {\n    value: this.HTMLImageElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Image\", {\n    value: Image,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n\n  function Audio(src) {\n    const audio = window._document.createElement(\"audio\");\n    const impl = idlUtils.implForWrapper(audio);\n    impl.setAttribute(\"preload\", \"auto\");\n\n    if (src !== undefined) {\n      impl.setAttribute(\"src\", String(src));\n    }\n\n    return audio;\n  }\n  Object.defineProperty(Audio, \"prototype\", {\n    value: this.HTMLAudioElement.prototype,\n    configurable: false,\n    enumerable: false,\n    writable: false\n  });\n  Object.defineProperty(window, \"Audio\", {\n    value: Audio,\n    configurable: true,\n    enumerable: false,\n    writable: true\n  });\n\n  function wrapConsoleMethod(method) {\n    return (...args) => {\n      window._virtualConsole.emit(method, ...args);\n    };\n  }\n\n  this.postMessage = postMessage;\n\n  this.atob = function (str) {\n    const result = atob(str);\n    if (result === null) {\n      throw new DOMException(\"The string to be decoded contains invalid characters.\", \"InvalidCharacterError\");\n    }\n    return result;\n  };\n\n  this.btoa = function (str) {\n    const result = btoa(str);\n    if (result === null) {\n      throw new DOMException(\"The string to be encoded contains invalid characters.\", \"InvalidCharacterError\");\n    }\n    return result;\n  };\n\n  this.FileReader = createFileReader({\n    window: this\n  }).interface;\n  this.WebSocket = createWebSocket({\n    window: this\n  }).interface;\n\n  const AbortSignalWrapper = createAbortSignal({\n    window: this\n  });\n  this.AbortSignal = AbortSignalWrapper.interface;\n  this.AbortController = createAbortController({\n    AbortSignal: AbortSignalWrapper\n  }).interface;\n\n  this.XMLHttpRequest = createXMLHttpRequest(this);\n\n  // TODO: necessary for Blob and FileReader due to different-globals weirdness; investigate how to avoid this.\n  this.ArrayBuffer = ArrayBuffer;\n  this.Int8Array = Int8Array;\n  this.Uint8Array = Uint8Array;\n  this.Uint8ClampedArray = Uint8ClampedArray;\n  this.Int16Array = Int16Array;\n  this.Uint16Array = Uint16Array;\n  this.Int32Array = Int32Array;\n  this.Uint32Array = Uint32Array;\n  this.Float32Array = Float32Array;\n  this.Float64Array = Float64Array;\n\n  this.stop = function () {\n    const manager = idlUtils.implForWrapper(this._document)._requestManager;\n    if (manager) {\n      manager.close();\n    }\n  };\n\n  this.close = function () {\n    // Recursively close child frame windows, then ourselves.\n    const currentWindow = this;\n    (function windowCleaner(windowToClean) {\n      for (let i = 0; i < windowToClean.length; i++) {\n        windowCleaner(windowToClean[i]);\n      }\n\n      // We\"re already in our own window.close().\n      if (windowToClean !== currentWindow) {\n        windowToClean.close();\n      }\n    }(this));\n\n    // Clear out all listeners. Any in-flight or upcoming events should not get delivered.\n    idlUtils.implForWrapper(this)._eventListeners = Object.create(null);\n\n    if (this._document) {\n      if (this._document.body) {\n        this._document.body.innerHTML = \"\";\n      }\n\n      if (this._document.close) {\n        // It's especially important to clear out the listeners here because document.close() causes a \"load\" event to\n        // fire.\n        idlUtils.implForWrapper(this._document)._eventListeners = Object.create(null);\n        this._document.close();\n      }\n      const doc = idlUtils.implForWrapper(this._document);\n      if (doc._requestManager) {\n        doc._requestManager.close();\n      }\n      delete this._document;\n    }\n\n    this.__stopAllTimers();\n    WebSocketImpl.cleanUpWindow(this);\n  };\n\n  this.getComputedStyle = function (node) {\n    const nodeImpl = idlUtils.implForWrapper(node);\n    const s = node.style;\n    const cs = new CSSStyleDeclaration();\n    const { forEach } = Array.prototype;\n\n    function setPropertiesFromRule(rule) {\n      if (!rule.selectorText) {\n        return;\n      }\n\n      const selectors = rule.selectorText.split(cssSelectorSplitRE);\n      let matched = false;\n      for (const selectorText of selectors) {\n        if (selectorText !== \"\" && selectorText !== \",\" && !matched && matchesDontThrow(nodeImpl, selectorText)) {\n          matched = true;\n          forEach.call(rule.style, property => {\n            cs.setProperty(property, rule.style.getPropertyValue(property), rule.style.getPropertyPriority(property));\n          });\n        }\n      }\n    }\n\n    function readStylesFromStyleSheet(sheet) {\n      forEach.call(sheet.cssRules, rule => {\n        if (rule.media) {\n          if (Array.prototype.indexOf.call(rule.media, \"screen\") !== -1) {\n            forEach.call(rule.cssRules, setPropertiesFromRule);\n          }\n        } else {\n          setPropertiesFromRule(rule);\n        }\n      });\n    }\n\n    readStylesFromStyleSheet(defaultStyleSheet);\n    forEach.call(node.ownerDocument.styleSheets, readStylesFromStyleSheet);\n\n    forEach.call(s, property => {\n      cs.setProperty(property, s.getPropertyValue(property), s.getPropertyPriority(property));\n    });\n\n    return cs;\n  };\n\n  // The captureEvents() and releaseEvents() methods must do nothing\n  this.captureEvents = function () {};\n\n  this.releaseEvents = function () {};\n\n  ///// PUBLIC DATA PROPERTIES (TODO: should be getters)\n\n  this.console = {\n    assert: wrapConsoleMethod(\"assert\"),\n    clear: wrapConsoleMethod(\"clear\"),\n    count: wrapConsoleMethod(\"count\"),\n    debug: wrapConsoleMethod(\"debug\"),\n    error: wrapConsoleMethod(\"error\"),\n    group: wrapConsoleMethod(\"group\"),\n    groupCollapsed: wrapConsoleMethod(\"groupCollapsed\"),\n    groupEnd: wrapConsoleMethod(\"groupEnd\"),\n    info: wrapConsoleMethod(\"info\"),\n    log: wrapConsoleMethod(\"log\"),\n    table: wrapConsoleMethod(\"table\"),\n    time: wrapConsoleMethod(\"time\"),\n    timeEnd: wrapConsoleMethod(\"timeEnd\"),\n    trace: wrapConsoleMethod(\"trace\"),\n    warn: wrapConsoleMethod(\"warn\")\n  };\n\n  function notImplementedMethod(name) {\n    return function () {\n      notImplemented(name, window);\n    };\n  }\n\n  define(this, {\n    name: \"nodejs\",\n    // Node v6 has issues (presumably in the vm module)\n    // which this property exposes through an XHR test\n    // status: \"\",\n    devicePixelRatio: 1,\n    innerWidth: 1024,\n    innerHeight: 768,\n    outerWidth: 1024,\n    outerHeight: 768,\n    pageXOffset: 0,\n    pageYOffset: 0,\n    screenX: 0,\n    screenY: 0,\n    scrollX: 0,\n    scrollY: 0,\n\n    // Not in spec, but likely to be added eventually:\n    // https://github.com/w3c/csswg-drafts/issues/1091\n    screenLeft: 0,\n    screenTop: 0,\n\n    alert: notImplementedMethod(\"window.alert\"),\n    blur: notImplementedMethod(\"window.blur\"),\n    confirm: notImplementedMethod(\"window.confirm\"),\n    focus: notImplementedMethod(\"window.focus\"),\n    moveBy: notImplementedMethod(\"window.moveBy\"),\n    moveTo: notImplementedMethod(\"window.moveTo\"),\n    open: notImplementedMethod(\"window.open\"),\n    print: notImplementedMethod(\"window.print\"),\n    prompt: notImplementedMethod(\"window.prompt\"),\n    resizeBy: notImplementedMethod(\"window.resizeBy\"),\n    resizeTo: notImplementedMethod(\"window.resizeTo\"),\n    scroll: notImplementedMethod(\"window.scroll\"),\n    scrollBy: notImplementedMethod(\"window.scrollBy\"),\n    scrollTo: notImplementedMethod(\"window.scrollTo\")\n  });\n\n  ///// INITIALIZATION\n\n  process.nextTick(() => {\n    if (!window.document) {\n      return; // window might've been closed already\n    }\n\n    if (window.document.readyState === \"complete\") {\n      const ev = window.document.createEvent(\"HTMLEvents\");\n      ev.initEvent(\"load\", false, false);\n      window.dispatchEvent(ev);\n    } else {\n      window.document.addEventListener(\"load\", () => {\n        const ev = window.document.createEvent(\"HTMLEvents\");\n        ev.initEvent(\"load\", false, false);\n        window.dispatchEvent(ev);\n      });\n    }\n  });\n}\n\nObject.setPrototypeOf(Window, EventTarget.interface);\nObject.setPrototypeOf(Window.prototype, EventTarget.interface.prototype);\nObject.defineProperty(Window.prototype, Symbol.toStringTag, {\n  value: \"Window\",\n  writable: false,\n  enumerable: false,\n  configurable: true\n});\n\nfunction startTimer(window, startFn, stopFn, timerId, callback, ms, timerStorage, args) {\n  if (!window || !window._document) {\n    return undefined;\n  }\n  if (typeof callback !== \"function\") {\n    const code = String(callback);\n    callback = window._globalProxy.eval.bind(window, code + `\\n//# sourceURL=${window.location.href}`);\n  }\n\n  const oldCallback = callback;\n  callback = () => {\n    try {\n      oldCallback.apply(window._globalProxy, args);\n    } catch (e) {\n      reportException(window, e, window.location.href);\n    }\n  };\n\n  const res = startFn(callback, ms);\n  timerStorage[timerId] = [res, stopFn];\n  return timerId;\n}\n\nfunction stopTimer(timerStorage, id) {\n  const timer = timerStorage[id];\n  if (timer) {\n    // Need to .call() with undefined to ensure the thisArg is not timer itself\n    timer[1].call(undefined, timer[0]);\n    delete timerStorage[id];\n  }\n}\n\nfunction stopAllTimers(timers) {\n  Object.keys(timers).forEach(key => {\n    const timer = timers[key];\n    // Need to .call() with undefined to ensure the thisArg is not timer itself\n    timer[1].call(undefined, timer[0]);\n  });\n}\n"]},"metadata":{},"sourceType":"script"}