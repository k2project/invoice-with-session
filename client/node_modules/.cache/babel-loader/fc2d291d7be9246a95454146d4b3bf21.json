{"ast":null,"code":"\"use strict\";\n\nconst DOMException = require(\"domexception\");\n\nconst StorageEvent = require(\"../generated/StorageEvent\");\n\nconst idlUtils = require(\"../generated/utils\"); // https://html.spec.whatwg.org/multipage/webstorage.html#the-storage-interface\n\n\nclass StorageImpl {\n  constructor(args, {\n    associatedWindow,\n    storageArea,\n    url,\n    type,\n    storageQuota\n  }) {\n    this._associatedWindow = associatedWindow;\n    this._items = storageArea;\n    this._url = url;\n    this._type = type;\n    this._quota = storageQuota;\n  }\n\n  _dispatchStorageEvent(key, oldValue, newValue) {\n    return this._associatedWindow._currentOriginData.windowsInSameOrigin.filter(target => target !== this._associatedWindow).forEach(target => target.dispatchEvent(StorageEvent.create([\"storage\", {\n      bubbles: false,\n      cancelable: false,\n      key,\n      oldValue,\n      newValue,\n      url: this._url,\n      storageArea: target[\"_\" + this._type]\n    }])));\n  }\n\n  get length() {\n    return this._items.size;\n  }\n\n  key(n) {\n    if (n >= this._items.size) {\n      return null;\n    }\n\n    return [...this._items.keys()][n];\n  }\n\n  getItem(key) {\n    if (this._items.has(key)) {\n      return this._items.get(key);\n    }\n\n    return null;\n  }\n\n  setItem(key, value) {\n    const oldValue = this._items.get(key) || null;\n\n    if (oldValue === value) {\n      return;\n    } // Concatenate all keys and values to measure their length against the quota\n\n\n    let itemsTotalLength = key.length + value.length;\n\n    for (const [curKey, curValue] of this._items) {\n      // If the key already exists, skip it as it will be set to the new value instead\n      if (key !== curKey) {\n        itemsTotalLength += curKey.length + curValue.length;\n      }\n    }\n\n    if (itemsTotalLength > this._quota) {\n      throw new DOMException(`The ${this._quota}-code unit storage quota has been exceeded.`, \"QuotaExceededError\");\n    }\n\n    setTimeout(this._dispatchStorageEvent.bind(this), 0, key, oldValue, value);\n\n    this._items.set(key, value);\n  }\n\n  removeItem(key) {\n    if (this._items.has(key)) {\n      setTimeout(this._dispatchStorageEvent.bind(this), 0, key, this._items.get(key), null);\n\n      this._items.delete(key);\n    }\n  }\n\n  clear() {\n    if (this._items.size > 0) {\n      setTimeout(this._dispatchStorageEvent.bind(this), 0, null, null, null);\n\n      this._items.clear();\n    }\n  }\n\n  get [idlUtils.supportedPropertyNames]() {\n    return this._items.keys();\n  }\n\n}\n\nmodule.exports = {\n  implementation: StorageImpl\n};","map":{"version":3,"sources":["/Users/krispol/Desktop/invoice/invoice-with-session/client/node_modules/jsdom/lib/jsdom/living/webstorage/Storage-impl.js"],"names":["DOMException","require","StorageEvent","idlUtils","StorageImpl","constructor","args","associatedWindow","storageArea","url","type","storageQuota","_associatedWindow","_items","_url","_type","_quota","_dispatchStorageEvent","key","oldValue","newValue","_currentOriginData","windowsInSameOrigin","filter","target","forEach","dispatchEvent","create","bubbles","cancelable","length","size","n","keys","getItem","has","get","setItem","value","itemsTotalLength","curKey","curValue","setTimeout","bind","set","removeItem","delete","clear","supportedPropertyNames","module","exports","implementation"],"mappings":"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","sourcesContent":["\"use strict\";\n\nconst DOMException = require(\"domexception\");\nconst StorageEvent = require(\"../generated/StorageEvent\");\nconst idlUtils = require(\"../generated/utils\");\n\n// https://html.spec.whatwg.org/multipage/webstorage.html#the-storage-interface\nclass StorageImpl {\n  constructor(args, { associatedWindow, storageArea, url, type, storageQuota }) {\n    this._associatedWindow = associatedWindow;\n    this._items = storageArea;\n    this._url = url;\n    this._type = type;\n    this._quota = storageQuota;\n  }\n\n  _dispatchStorageEvent(key, oldValue, newValue) {\n    return this._associatedWindow._currentOriginData.windowsInSameOrigin\n      .filter(target => target !== this._associatedWindow)\n      .forEach(target => target.dispatchEvent(StorageEvent.create([\n        \"storage\",\n        {\n          bubbles: false,\n          cancelable: false,\n          key,\n          oldValue,\n          newValue,\n          url: this._url,\n          storageArea: target[\"_\" + this._type]\n        }\n      ])));\n  }\n\n  get length() {\n    return this._items.size;\n  }\n\n  key(n) {\n    if (n >= this._items.size) {\n      return null;\n    }\n    return [...this._items.keys()][n];\n  }\n\n  getItem(key) {\n    if (this._items.has(key)) {\n      return this._items.get(key);\n    }\n    return null;\n  }\n\n  setItem(key, value) {\n    const oldValue = this._items.get(key) || null;\n\n    if (oldValue === value) {\n      return;\n    }\n\n    // Concatenate all keys and values to measure their length against the quota\n    let itemsTotalLength = key.length + value.length;\n    for (const [curKey, curValue] of this._items) {\n      // If the key already exists, skip it as it will be set to the new value instead\n      if (key !== curKey) {\n        itemsTotalLength += curKey.length + curValue.length;\n      }\n    }\n    if (itemsTotalLength > this._quota) {\n      throw new DOMException(`The ${this._quota}-code unit storage quota has been exceeded.`, \"QuotaExceededError\");\n    }\n\n    setTimeout(this._dispatchStorageEvent.bind(this), 0, key, oldValue, value);\n\n    this._items.set(key, value);\n  }\n\n  removeItem(key) {\n    if (this._items.has(key)) {\n      setTimeout(this._dispatchStorageEvent.bind(this), 0, key, this._items.get(key), null);\n\n      this._items.delete(key);\n    }\n  }\n\n  clear() {\n    if (this._items.size > 0) {\n      setTimeout(this._dispatchStorageEvent.bind(this), 0, null, null, null);\n\n      this._items.clear();\n    }\n  }\n\n  get [idlUtils.supportedPropertyNames]() {\n    return this._items.keys();\n  }\n}\n\nmodule.exports = {\n  implementation: StorageImpl\n};\n"]},"metadata":{},"sourceType":"script"}