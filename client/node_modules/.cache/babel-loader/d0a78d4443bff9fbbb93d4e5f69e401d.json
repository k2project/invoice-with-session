{"ast":null,"code":"var _jsxFileName = \"/Users/krispol/Desktop/invoice/invoice-with-session/client/src/pages/account/DeleteAccount.js\";\nimport React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { setAlert } from '../../redux/actions/messages';\nimport { endSession } from '../../redux/actions/session';\nimport axios from 'axios';\nimport FormInput from '../../components/form/components/FormInput';\nimport FormErrorsDisplay from '../../components/form/components/FormErrorsDisplay';\nimport { formErrorsStyling, updateStateErrors } from '../../components/form/utils/formFuns';\n\nconst DeleteAccount = ({\n  user,\n  setAlert,\n  endSession\n}) => {\n  const deleteAccount = async e => {\n    e.preventDefault();\n    const form = e.target;\n    const {\n      password\n    } = formData;\n    const {\n      _id\n    } = user;\n\n    try {\n      const config = {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      };\n      const body = JSON.stringify({\n        _id,\n        password\n      });\n      await axios.post('/api/user/unregister', body, config);\n      await axios.delete('/api/user/unregister');\n      endSession();\n      setAlert('Your account has been deleted successfully. We are sorry to see you going...', 'success', 'sign up page', false);\n    } catch (err) {\n      updateStateErrors(form, formData, setFormData, err.response.data.errors);\n    }\n  };\n\n  const [formData, setFormData] = useState({\n    password: '',\n    errors: []\n  });\n  useEffect(() => {\n    formErrorsStyling(formData.errors);\n  }, [formData.errors]);\n  return /*#__PURE__*/React.createElement(\"section\", {\n    className: \"delete-account account\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 13\n    }\n  }, \"Delete your account.\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 13\n    }\n  }, \"Once you delete your account, there is no going back. Please be certain.\"), /*#__PURE__*/React.createElement(\"form\", {\n    className: \"tile\",\n    onSubmit: deleteAccount,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(FormInput, {\n    form: {\n      formData,\n      setFormData\n    },\n    type: \"password\",\n    name: \"password\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 17\n    }\n  }, \"Enter password to confirm the deactivation of your account.\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn--danger btn--sibling\",\n    onMouseDown: e => e.preventDefault(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 17\n    }\n  }, \"Delete account\"), formData.password.length > 0 && /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn\",\n    onMouseDown: e => e.preventDefault(),\n    onClick: () => setFormData({\n      password: '',\n      errors: []\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 21\n    }\n  }, \"Cancel\")), formData.errors.length > 0 && /*#__PURE__*/React.createElement(FormErrorsDisplay, {\n    errors: formData.errors,\n    label: \"Delete account form\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 17\n    }\n  }));\n};\n\nDeleteAccount.propTypes = {\n  user: PropTypes.object,\n  setAlert: PropTypes.func,\n  endSession: PropTypes.func\n};\n\nconst mapStateToProps = state => ({\n  user: state.user\n});\n\nconst mapDispatchToProps = {\n  setAlert,\n  endSession\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(DeleteAccount);","map":{"version":3,"sources":["/Users/krispol/Desktop/invoice/invoice-with-session/client/src/pages/account/DeleteAccount.js"],"names":["React","useEffect","useState","PropTypes","connect","setAlert","endSession","axios","FormInput","FormErrorsDisplay","formErrorsStyling","updateStateErrors","DeleteAccount","user","deleteAccount","e","preventDefault","form","target","password","formData","_id","config","headers","body","JSON","stringify","post","delete","err","setFormData","response","data","errors","length","propTypes","object","func","mapStateToProps","state","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { setAlert } from '../../redux/actions/messages';\nimport { endSession } from '../../redux/actions/session';\nimport axios from 'axios';\nimport FormInput from '../../components/form/components/FormInput';\nimport FormErrorsDisplay from '../../components/form/components/FormErrorsDisplay';\nimport {\n    formErrorsStyling,\n    updateStateErrors,\n} from '../../components/form/utils/formFuns';\n\nconst DeleteAccount = ({ user, setAlert, endSession }) => {\n    const deleteAccount = async (e) => {\n        e.preventDefault();\n        const form = e.target;\n        const { password } = formData;\n        const { _id } = user;\n        try {\n            const config = {\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n            };\n\n            const body = JSON.stringify({ _id, password });\n\n            await axios.post('/api/user/unregister', body, config);\n            await axios.delete('/api/user/unregister');\n            endSession();\n            setAlert(\n                'Your account has been deleted successfully. We are sorry to see you going...',\n                'success',\n                'sign up page',\n                false\n            );\n        } catch (err) {\n            updateStateErrors(\n                form,\n                formData,\n                setFormData,\n                err.response.data.errors\n            );\n        }\n    };\n    const [formData, setFormData] = useState({\n        password: '',\n        errors: [],\n    });\n    useEffect(() => {\n        formErrorsStyling(formData.errors);\n    }, [formData.errors]);\n    return (\n        <section className='delete-account account'>\n            <h2>Delete your account.</h2>\n            <p>\n                Once you delete your account, there is no going back. Please be\n                certain.\n            </p>\n            <form className='tile' onSubmit={deleteAccount}>\n                <FormInput\n                    form={{ formData, setFormData }}\n                    type='password'\n                    name='password'\n                >\n                    Enter password to confirm the deactivation of your account.\n                </FormInput>\n                <button\n                    className='btn btn--danger btn--sibling'\n                    onMouseDown={(e) => e.preventDefault()}\n                >\n                    Delete account\n                </button>\n                {formData.password.length > 0 && (\n                    <button\n                        className='btn'\n                        onMouseDown={(e) => e.preventDefault()}\n                        onClick={() =>\n                            setFormData({\n                                password: '',\n                                errors: [],\n                            })\n                        }\n                    >\n                        Cancel\n                    </button>\n                )}\n            </form>\n            {formData.errors.length > 0 && (\n                <FormErrorsDisplay\n                    errors={formData.errors}\n                    label='Delete account form'\n                />\n            )}\n        </section>\n    );\n};\n\nDeleteAccount.propTypes = {\n    user: PropTypes.object,\n    setAlert: PropTypes.func,\n    endSession: PropTypes.func,\n};\nconst mapStateToProps = (state) => ({\n    user: state.user,\n});\nconst mapDispatchToProps = {\n    setAlert,\n    endSession,\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(DeleteAccount);\n"]},"metadata":{},"sourceType":"module"}